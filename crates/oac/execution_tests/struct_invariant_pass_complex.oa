struct Envelope {
	raw: I32,
	abs: I32,
	checksum: I32,
}

fun __struct__Envelope__invariant(v: Envelope) -> Bool {
	paired = v.abs == v.raw || v.abs == (0 - v.raw)
	stable = v.checksum == 0
	return v.abs >= 0 && paired && stable
}

fun normalize(x: I32) -> I32 {
	if x < 0 {
		return 0 - x
	} else {
		return x
	}
}

fun build_raw(seed: I32, argc: I32) -> I32 {
	if seed < argc {
		return (argc - seed) - 1
	} else {
		delta = seed - argc
		doubled = delta + delta
		padded = doubled + argc
		return padded - delta
	}
}

fun make_envelope(seed: I32, argc: I32) -> Envelope {
	raw = build_raw(seed, argc)
	abs = normalize(raw)
	// Equivalent to 0 when abs == +/- raw, but keeps the expression non-trivial.
	checksum = (abs - raw) + (abs + raw) - (abs + abs)
	return Envelope struct { raw: raw, abs: abs, checksum: checksum, }
}

fun main(argc: I32, argv: I64) -> I32 {
	seed = (argc + argc) + 7
	env = make_envelope(seed, argc)
	print(env.abs)
	return 0
}
